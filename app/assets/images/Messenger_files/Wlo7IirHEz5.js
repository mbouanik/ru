if (self.CavalryLogger) { CavalryLogger.start_js(["RPqEP"]); }

__d("NotificationListItemBase.react",["csx","cx","AsyncResponse","BizSiteIdentifier.brands","Bootloader","InternalNotificationOptionHandler","LogicalGridCell.react","LogicalGridRow.react","NotificationConstants","NotificationListConfig","NotificationListItemChevron.react","NotificationListItemContents.react","NotificationListItemOptionConfirmation.react","NotificationListItemReadToggle.react","NotificationTracking","NotificationUpdates","NotificationUserActions","NotifTestIDs","Parent","React","ReactDOM","Style","SubscriptionsHandler","TrackingNodes","compactArray","createObjectFrom","promiseDone"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i;b("BizSiteIdentifier.brands").isBizSite();-1;function j(a){__p&&__p();if(a.length===0)return;a=a[0];var c=a.description,d=a.is_silent,e=a.is_transient;a=a.message;var f=new(b("AsyncResponse"))();f.errorSummary=c;f.errorDescription=a;f.silentError=d;f.transientError=e;b("AsyncResponse").defaultErrorHandler(f)}c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.prefetched=!1,this.isLiveVideo=null,this.$1=!1,this.$3=new(b("SubscriptionsHandler"))(),this.state={actionsTaken:[],hasError:!1,sendingFeedback:!1},this.$5=function(){b("NotificationUserActions").setNextIsFromReadButton(!0),this.props.isRead?this.props.canMarkUnread&&(this.props.onMarkItemUnread&&this.props.onMarkItemUnread()):this.props.onMarkItemRead&&this.props.onMarkItemRead()}.bind(this),this.$8=function(a){__p&&__p();var c,d=(c=a)!=null?(c=c.client_info)!=null?c.action_type:c:c;if(d==null)return;if(b("InternalNotificationOptionHandler").tryHandle(this.$4(),a,this.props.getDebugData))return;var e=a.server_action;if(e==null)return;this.setState({sendingFeedback:!0});b("promiseDone")(b("NotificationUserActions").sendNotifOption(e),function(c){__p&&__p();if(this.$1)return;this.setState(function(f){var g;g=(g=c)!=null?(g=g.notif_option_action)!=null?(g=g.notification)!=null?(g=g.notif_option_sets)!=null?(g=g.edges)!=null?(g=g[0])!=null?(g=g.node)!=null?(g=g.notif_options)!=null?g.edges:g:g:g:g:g:g:g:g;f=babelHelpers["extends"]({},f,{actionsTaken:f.actionsTaken.concat([{actionToken:e,type:d,nextNotificationOptions:g&&b("compactArray")(g.map(function(a){a=a.node;return a})),undoText:(f=a)!=null?(f=f.option_display)!=null?f.undo_text:f:f,undoToken:(g=a)!=null?(g=g.client_info)!=null?g.undo_server_action:g:g}]),sendingFeedback:!1});b("NotificationUpdates").handleUpdate(b("NotificationConstants").PayloadSourceType.USER_ACTION,{hiddenState:b("createObjectFrom")([this.$4()],this.$11(f))});return f}.bind(this))}.bind(this),this.$13)}.bind(this),this.$14=function(){__p&&__p();var a=this.$4();this.setState({sendingFeedback:!0});var c=this.state.actionsTaken[this.state.actionsTaken.length-1];c&&c.undoToken!=null&&b("promiseDone")(b("NotificationUserActions").sendNotifOption(c.undoToken),function(c){if(this.$1)return;this.setState(function(c){c=babelHelpers["extends"]({},c,{actionsTaken:c.actionsTaken.slice(0,this.state.actionsTaken.length-1),sendingFeedback:!1});b("NotificationUpdates").handleUpdate(b("NotificationConstants").PayloadSourceType.USER_ACTION,{hiddenState:b("createObjectFrom")([a],this.$11(c))});return c}.bind(this))}.bind(this),this.$13)}.bind(this),this.$13=function(a){a=a.errors;if(this.$1)return;j(a);this.setState({sendingFeedback:!1})}.bind(this),c}a.prototype.$4=function(){"use strict";return this.props.notification.alert_id};a.prototype.$6=function(){"use strict";var a=this.props,c=a.canMarkUnread;a=a.isRead;return b("React").createElement(b("NotificationListItemReadToggle.react"),{className:"_55m9 _55ma",canMarkUnread:c,isRead:!!a,onToggleClick:this.$5})};a.prototype.$7=function(){var a=this.props,c=a.onChevronHide,d=a.onChevronShow;a=a.notification;var e=a.alert_id,f=a.notif_option_sets;a=a.notif_type;f=(f=f)!=null?(f=f.edges)!=null?(f=f[0])!=null?(f=f.node)!=null?(f=f.notif_options)!=null?f.edges:f:f:f:f:f;return b("React").createElement(b("NotificationListItemChevron.react"),{alert_id:e,className:"_55m9",notif_type:a,notificationOptions:f&&b("compactArray")(f.map(function(a){a=a.node;return a})),onHide:c,onMenuOptionClick:this.$8,onShow:d})};a.prototype.shouldComponentUpdate=function(a,b){"use strict";b=this.props.visible!==a.visible||this.props.isRead!==a.isRead||this.props.isSelected!==a.isSelected||this.props.notification.timestamp!==a.notification.timestamp||this.state.actionsTaken.length!==b.actionsTaken.length||this.state.sendingFeedback!==b.sendingFeedback||this.state.hasError!==b.hasError;return b||!!this.props.hasCustomForeground&&this.props.paused!==a.paused};a.prototype.UNSAFE_componentWillUpdate=function(a){"use strict";if(!this.$2||!a.isSelected||this.props.isSelected)return;a=b("ReactDOM").findDOMNode(this.$2);a&&a.scrollIntoViewIfNeeded&&a.scrollIntoViewIfNeeded(!1)};a.prototype.UNSAFE_componentWillReceiveProps=function(a){"use strict";this.props.paused&&!a.paused&&!this.props.visible&&this.state.actionsTaken.length>0&&this.setState({actionsTaken:[]})};a.prototype.componentDidMount=function(){"use strict";if(this.$9()){var a=b("Bootloader").loadModules(["VideoPlayerMetaData"],function(a){b("promiseDone")(a.genVideoData(this.$10()),null,function(a){this.setState({hasError:!0})}.bind(this))}.bind(this),"NotificationListItemBase.react");this.$3.addSubscriptions(a)}};a.prototype.componentDidUpdate=function(){"use strict";if(this.props.enableHubView&&this.props.isSelected&&this.$2){var a=b("ReactDOM").findDOMNode(this.$2);a&&typeof a.focus==="function"&&a.focus()}};a.prototype.componentWillUnmount=function(){"use strict";this.$3&&this.$3.release(),delete this.$3};a.prototype.$11=function(a){a===void 0&&(a=this.state);return a.actionsTaken.some(function(a){return a.type==="HIDE"})};a.prototype.$12=function(){"use strict";var a=b("ReactDOM").findDOMNode(this);if(!a)return!1;a=b("Parent").bySelector(a,".__tw");a=a?a.parentNode:null;return a?b("Style").get(a,"display")!=="none":!1};a.prototype.$15=function(a){"use strict";if(this.state.actionsTaken.length>=2)return null;var b={};this.state.actionsTaken.forEach(function(a){b[a.actionToken]=!0});return a.filter(function(a){a=a.server_action;return a==null||b[a]!==!0})};a.prototype.$10=function(){"use strict";var a=b("NotificationTracking").getEncodedTrackingData(this.props.notification,this.props.row);return a.content_id||null};a.prototype.$9=function(){"use strict";if(this.isLiveVideo===null){var a=b("NotificationTracking").getTrackingString(this.props.notification,this.props.row);this.isLiveVideo=a.indexOf("live_video")!==-1}return!!this.isLiveVideo};a.prototype.render=function(){"use strict";__p&&__p();if(this.state.hasError)return null;if(!this.props.visible&&!this.$11())return b("React").createElement("li",{className:"_4_62"});var a="_33c"+(b("NotificationListConfig").isWork?" _1rqj":"")+(this.props.isRead?"":" jewelItemNew")+(this.state.sendingFeedback?" _4m8s":"")+(this.props.hasCustomForeground?" _3u5n":"")+(this.props.isSelected?" _u-o":""),c=b("NotificationTracking").getTrackingString(this.props.notification,this.props.row),d=this.props.rowIndex;if(this.state.actionsTaken.length>0){var e=this.state.actionsTaken[this.state.actionsTaken.length-1];return b("React").createElement("li",{className:a,"data-gt":c,"data-testid":b("NotifTestIDs").NOTIF_LIST_ITEM},b("React").createElement(b("LogicalGridRow.react"),{className:"_dre",rowIndex:d,component:b("React").createElement("div",null)},b("React").createElement(b("LogicalGridCell.react"),{columnIndex:0,component:b("React").createElement("div",null)},b("React").createElement(b("NotificationListItemOptionConfirmation.react"),{notificationOptions:e.nextNotificationOptions?this.$15(e.nextNotificationOptions):null,onUndoClick:this.$14,onMenuOptionClick:this.$8,undoText:e.undoText,undoToken:e.undoToken}))))}e=b("React").createElement(b("NotificationListItemContents.react"),this.props);e=this.props.renderLink(e);return b("React").createElement("li",{className:a,"data-ft":b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.NOTIFICATION_ITEM,this.props.row),"data-gt":c,"data-alert-id":this.$4(),"data-testid":b("NotifTestIDs").NOTIF_LIST_ITEM},b("React").createElement(b("LogicalGridRow.react"),{className:"_dre anchorContainer",rowIndex:d,component:b("React").createElement("div",null)},b("React").createElement(b("LogicalGridCell.react"),{columnIndex:0,component:b("React").createElement("div",null)},e),b("React").createElement("ul",{className:"_55mc"},b("React").createElement(b("LogicalGridCell.react"),{columnIndex:1,component:b("React").createElement("li",{className:"_h_c"})},this.$6()),b("React").createElement(b("LogicalGridCell.react"),{columnIndex:2,component:b("React").createElement("li",{className:"_h_d"}),disableFocusRecovery:!0},this.$7()))))};e.exports=a}),null);