if (self.CavalryLogger) { CavalryLogger.start_js(["b6WCw"]); }

__d("ChatSpeakingSticker.react",["React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);g=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$1=function(){var a=b("ReactDOM").findDOMNode(this.refs.stickerVideo);a.play()}.bind(this),c}a.prototype.render=function(){return b("React").createElement("div",{onClick:this.$1,role:"presentation"},b("React").createElement("video",{height:this.props.videoSize.height,ref:"stickerVideo",width:this.props.videoSize.width},b("React").createElement("source",{src:this.props.videoURI})))};a.propTypes={videoURI:c.string.isRequired,videoSize:c.shape({height:c.number,width:c.number}).isRequired};e.exports=a}),null);
__d("MessengerAttachmentViewer",["Bootloader","MessagesViewer","React","Run","emptyFunction"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={renderVideo:function(a){b("Bootloader").loadModules(["MessagingVideoViewer.react","MessengerForwardAttachmentDialogReact.bs"],function(c,d){d=d.jsComponent;b("MessagesViewer").renderVideo(b("React").createElement(c,babelHelpers["extends"]({},a,{forwardDialogComponent:d})))},"MessengerAttachmentViewer")},bootstrapWithConfig:function(a,c){b("Bootloader").loadModules(["SpotlightMessagesViewer","MessengerForwardAttachmentDialogReact.bs"],function(d,e){e=e.jsComponent;b("MessagesViewer").renderSpotlight(a,c,d,e)},"MessengerAttachmentViewer")},preload:function(){b("Run").onAfterLoad(function(){b("Bootloader").loadModules(["MessagingVideoViewer.react","SpotlightMessagesViewer","MessengerForwardAttachmentDialogReact.bs"],b("emptyFunction"),"MessengerAttachmentViewer")})}};e.exports=a}),null);
__d("ChatSpeakingStickerReact.bs",["ReasonReact.bs","ChatSpeakingSticker.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){return b("ReasonReact.bs").wrapJsForReason(b("ChatSpeakingSticker.react"),{videoURI:a,videoSize:c},d)}f.make=a}),null);
__d("MercuryAttachmentPayload.bs",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){b=b?b[0]:null;return{app_attribution:null,attach_type:a,deduplication_key:null,description:null,icon_type:null,key:b,large_preview_height:null,large_preview_width:null,large_preview_url:null,media:null,metadata:null,message_file_fbid:null,name:null,photo_encodings:null,preview_height:null,preview_uploading:null,preview_url:null,preview_width:null,rel:null,share:null,source:null,target:null,thumbnail_url:null,upload_id:null,uri:null,url:c,video_title:null}}f.create=a}),null);
__d("SphericalPhotoViewerInMessengerThreadBootloaded.react",["cx","BootloadedComponent.react","CssBackgroundImage.react","JSResource","PhotoProjection","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("PhotoProjection").PERSPECTIVE;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){__p&&__p();if(this.props.photoEncodings&&this.props.thumbnail){var a=this.props.photoEncodings.find(function(a){return a.projection_type===i}),c=null,d=null;if(a&&a.thumbnails&&a.thumbnails.length>0){a=a.thumbnails;c=a[0]?a[0].uri:null;d=a[1]?a[1].uri:null}if(this.props.useRenderer&&this.props.width&&this.props.height&&this.props.fbid){a=d||c||this.props.thumbnail;return b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("SphericalPhotoViewerInMessengerThreadWrapper.react").__setRef("SphericalPhotoViewerInMessengerThreadBootloaded.react"),bootloadPlaceholder:b("React").createElement(b("CssBackgroundImage.react"),{backgroundPosition:"center",imageURI:a,className:"_3v3t"}),height:this.props.height,width:this.props.width,fbid:this.props.fbid,thumbnail:a,photoEncodings:this.props.photoEncodings,isVisible:this.props.isVisible,onClickHandler:this.props.onClickHandler})}else{a=c||d||this.props.thumbnail;return b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("SphericalPhotoMessengerThumbnail.react").__setRef("SphericalPhotoViewerInMessengerThreadBootloaded.react"),bootloadPlaceholder:b("React").createElement(b("CssBackgroundImage.react"),{backgroundPosition:"center",imageURI:a,className:"_3v3t"}),photoEncodings:this.props.photoEncodings,thumbnail:a})}}return null};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("MessengerSphericalPhotoReact.bs",["Utils.bs","ReasonReact.bs","bs_js_null_undefined","SphericalPhotoViewerInMessengerThreadBootloaded.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g,h,i,j){return b("ReasonReact.bs").wrapJsForReason(b("SphericalPhotoViewerInMessengerThreadBootloaded.react"),{height:b("bs_js_null_undefined").fromOption(a),width:b("bs_js_null_undefined").fromOption(c),fbid:b("bs_js_null_undefined").fromOption(d),thumbnail:b("bs_js_null_undefined").fromOption(e),photoEncodings:b("bs_js_null_undefined").fromOption(f),isVisible:b("Utils.bs").optionBoolToBool(g),onClickHandler:h,useRenderer:i},j)}f.make=a}),null);
__d("MessengerPhotoReact.bs",["cx","fbt","bs_curry","React","Utils.bs","LinkReact.bs","cssURL","ImageReact.bs","ReasonReact.bs","joinClasses","bs_js_primitive","bs_caml_primitive","MercuryAttachmentType","MessengerSpinnerReact.bs","bs_caml_builtin_exceptions","MessengerSphericalPhotoReact.bs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();function i(a,c){__p&&__p();var d=a.metadata;if(d==null)return null;else if(a.attach_type===b("MercuryAttachmentType").VIDEO){var e=c&&!(d.large_preview==null);if(e)return d.large_preview;else return d.inbox_preview}else if(c)return a.large_preview_url;else return a.preview_url}function j(a){if(a==null)return[null,null];else return[a.width,a.height]}function k(a){__p&&__p();var c=window.screen.width>1800;if(b("Utils.bs").isTruthy(a.preview_uploading)){var d=function(b,c){var a=!(b==null);if(a)return b;else return c},e=c&&!(a.large_preview_url==null);if(e)return[[d(a.large_preview_width,480),d(a.large_preview_height,480),a.large_preview_url,c]];else return[[d(a.preview_width,280),d(a.preview_height,280),a.preview_url,c]]}else{e=i(a,c);d=!(e==null);var f=a.metadata;if(d&&!(f==null)){d=c&&!(f.large_size==null);d=d?f.large_size:f.inbox_size;f=j(d);return[[f[0],f[1],e,c]]}else d=1;if(d===1)if(a.preview_url==null){f=a.media;if(f==null)return 0;else{e=!(f.playable==null)&&!(f.animated_image==null);if(e){d=j(f.animated_image_size);return[[d[0],d[1],f.animated_image,c]]}else{e=j(f.image_size);return[[e[0],e[1],f.image,c]]}}}else{d=c&&!(a.large_preview_url==null);if(d)return[[a.large_preview_width,a.large_preview_height,a.large_preview_url,c]];else return[[a.preview_width,a.preview_height,a.preview_url,c]]}}}function l(a){__p&&__p();var c=function(a){return[""+(String(a)+"")]};if(b("Utils.bs").isTruthy(a.preview_uploading)){var d=!(a.preview_url==null);return c(d?0:280)}else{var e=function(a){var b=a[1];a=a[0];if(!(a==null)&&!(b==null))return[[a,b]];else return 0};d=function(a){if(a){a=a[0];return e([a[0],a[1]])}else return 0};var f=!(a.media==null);f=f?d(k(a)):e([a.preview_width,a.preview_height]);if(f){d=f[0];return c(b("bs_caml_primitive").caml_float_min(d[1]*b("bs_caml_primitive").caml_float_min(1,450/d[0]),450))}else return 0}}function m(a,c,d,e,f){b("Utils.bs").isTruthy(e.preview_uploading);e=a[2];if(e==null||!f)return null;else{f=a[3];a=f?window.screen.height*.7:window.screen.height*.65;f={maxHeight:""+(String(a)+""),maxWidth:"100%",width:"100%"};return b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make([b("joinClasses")(d,c?"":"_5pf5")],[""],0,0,[e],0,0,0,[f],[]))}}var n=b("ReasonReact.bs").statelessComponent("MessengerPhoto");function a(a,c,d,e,f,g,i){__p&&__p();var j=a?a[0]:"";return[n[0],n[1],n[2],n[3],function(){if(f)return b("bs_curry")._1(f[0],0);else return 0},n[5],n[6],n[7],function(){__p&&__p();var a=k(c);if(a){a=a[0];var f=c.attach_type===b("MercuryAttachmentType").ANIMATED_IMAGE,n=!(c.app_attribution==null),o=c.photo_encodings;o=o==null?!1:o.length!==0;var p=(!f||!d)&&!o;if(p){p=a[2];p=p==null?0:[b("cssURL")(p)];var q=d?l(c):0;p=[p,q]}else p=[0,0];q={};var r=p[0];r&&(q.backgroundImage=r[0]);r=p[1];r&&(q.minHeight=r[0]);p=q;r=b("Utils.bs").isTruthy(c.preview_uploading);q=r?b("ReasonReact.bs").element(0,0,b("MessengerSpinnerReact.bs").make(0,0,0,[])):null;r=f?[b("MercuryAttachmentType").ANIMATED_IMAGE]:0;var s=function(){if(g)return b("bs_curry")._1(g[0],c);else return 0},t=function(a){a.preventDefault();return s(0)};if(o){var u=a[2],v=c.metadata,w;if(v==null)w=0;else{v=v.fbid;w=v==null?0:[v]}v=c.photo_encodings;w=b("ReasonReact.bs").element(0,0,b("MessengerSphericalPhotoReact.bs").make([400],[400],w,u==null?0:[u],v==null?0:[v],e,s,d,[]))}else w=m(a,d&&f,(n?"_mxz":"")+(d&&!n?" _52mr":"")+(d&&!n?" _1byr":""),c,d);return b("React").cloneElement(b("React").createElement("div",{className:b("joinClasses")(j,"_4tsk"+(n?" _mxz":"")+(d&&!n?" _52mr":"")+(d&&!n?" _1byr":"")+(b("Utils.bs").isTruthy(c.preview_uploading)&&a[2]==null?" _3etv":"")+(o&&!d?" _3603":"")),role:"presentation",style:p,onClick:t}),{"data-testid":r},b("React").createElement("div",{className:o&&!d?"_64ks":""}),b("ReasonReact.bs").element(0,0,b("LinkReact.bs").make(0,0,[h._("Open Photo")],["_4tsl"],0,0,0,0,0,b("bs_js_primitive").null_undefined_to_opt(a[2]),0,0,0,0,0,0,0,0,0,[i])),w,q)}else return null},n[9],n[10],n[11],n[12]]}c=280;d=480;e=1800;g=450;f.preview_thumbnail_size=c;f.preview_large_size=d;f.large_window_width=e;f.max_photo_width=g;f.getSrcFromAttachment=i;f.sizeToWidthHeight=j;f.extractPreviewMetadata=k;f.getMinHeightForAttachment=l;f.getImageFromMetadata=m;f.component=n;f.make=a}),null);
__d("MessengerSharedMediaReducer",["JSReliabilityFixesGatingConfig","MessengerSharedMediaActions","MessengerThreadSharedMediaHelper"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MessengerSharedMediaActions").Types;function a(a,c){__p&&__p();switch(c.type){case g.LOAD_CURRENT:var d=a.get("sharedMedia").get(c.threadFBID);if(d){d=d.edges.find(function(a){return a.node.legacy_attachment_id===c.photoID});if(d)return a}d=a.get("isLoading").get(c.threadFBID);if(!!d&&d.curr)return a;d=l(a,c.threadFBID,"curr",!0);b("MessengerThreadSharedMediaHelper").search(c.threadFBID,c.photoID,function(a){return b("MessengerSharedMediaActions").currentLoaded(a)});return d}return a}function c(a,c){__p&&__p();switch(c.type){case g.LOAD_MORE_PREVIOUS:var d=a.get("isLoading").get(c.threadFBID);if(!!d&&d.prev)return a;d=l(a,c.threadFBID,"prev",!0);if(d===null)return a;b("MessengerThreadSharedMediaHelper").loadMorePrevious(c.threadFBID,c.afterCursor,c.first,function(a){return b("MessengerSharedMediaActions").previousLoaded(a)});return d}return a}function d(a,c){__p&&__p();switch(c.type){case g.LOAD_MORE_LATEST:var d=a.get("isLoading").get(c.threadFBID);if(!!d&&d.latest)return a;d=l(a,c.threadFBID,"latest",!0);if(d===null)return a;b("MessengerThreadSharedMediaHelper").loadMoreLatest(c.threadFBID,c.beforeCursor,c.last,function(a){return b("MessengerSharedMediaActions").latestLoaded(a)});return d}return a}function f(a,c){__p&&__p();var d;switch(c.type){case g.CURRENT_LOADED:c=c.data;var e=Object.keys(c)[0],f=b("JSReliabilityFixesGatingConfig").should_get_fix;d=f?(d=c[e])!=null?d.message_shared_media:d:c[e].message_shared_media;f=f?(c=d)!=null?(c=c.edges)!=null?c.length:c:c:d.edges.length;c=l(a,e,"curr",!1);if(f!==0){f=k(a.get("sharedMedia").get(e),d,0);f=a.get("sharedMedia").set(e,f);c=c.set("sharedMedia",f);f=d.edges[0];b("MessengerThreadSharedMediaHelper").loadMorePrevious(e,f.cursor,10,function(a){return b("MessengerSharedMediaActions").previousLoaded(a)});b("MessengerThreadSharedMediaHelper").loadMoreLatest(e,f.cursor,10,function(a){return b("MessengerSharedMediaActions").latestLoaded(a)})}return c}return a}function h(a,b){__p&&__p();switch(b.type){case g.PREVIOUS_LOADED:b=b.data;var c=Object.keys(b)[0];b=b[c].message_shared_media;var d=l(a,c,"prev",!1);b=k(a.get("sharedMedia").get(c),b,1);c=a.get("sharedMedia").set(c,b);d=d.set("sharedMedia",c);return d}return a}function i(a,b){__p&&__p();switch(b.type){case g.LATEST_LOADED:b=b.data;var c=Object.keys(b)[0];b=b[c].message_shared_media;var d=l(a,c,"latest",!1);b=k(a.get("sharedMedia").get(c),b,-1);c=a.get("sharedMedia").set(c,b);d=d.set("sharedMedia",c);return d}return a}function j(a,b){__p&&__p();switch(b.type){case g.DELETE_PHOTOS:var c=b.threadFBID;b=b.photoFBIDs;var d=a.get("sharedMedia").get(c);if(!d||!d.edges)break;var e=new Set(b.map(function(a){return a.toString()}));d.edges=d.edges.filter(function(a){return!e.has(a.node.legacy_attachment_id)});b=a.get("sharedMedia").set(c,d);c=a.set("sharedMedia",b);return c}return a}function k(a,b,c){__p&&__p();var d={};d.count=b.count;if(c===1&&a){var e=a.edges;d.has_previous_page=a.has_previous_page;d.has_next_page=b.page_info.has_next_page;b.edges.length>0?d.edges=e.concat(b.edges):d.edges=e}else if(c===-1&&a){e=a.edges;d.has_previous_page=b.page_info.has_previous_page;d.has_next_page=a.has_next_page;b.edges.length>0?d.edges=b.edges.concat(e):d.edges=e}else d.has_previous_page=b.page_info.has_previous_page,d.has_next_page=b.page_info.has_next_page,b.edges.length>0&&(d.edges=b.edges);return d}function l(a,b,c,d){var e=a.get("isLoading").get(b);e===undefined?(e={},e[c]=d):e[c]=d;c=a.set("isLoading",a.get("isLoading").set(b,e));return c}f={currentLoaded:f,deletePhotos:j,latestLoaded:i,loadCurrent:a,loadMoreLatest:d,loadMorePrevious:c,previousLoaded:h};e.exports=f}),null);
__d("MessengerSharedMediaState",["immutable"],(function(a,b,c,d,e,f){"use strict";var g;c={sharedMedia:b("immutable").Map({}),isLoading:b("immutable").Map({})};g=babelHelpers.inherits(a,b("immutable").Record(c));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MessengerSharedMediaStore",["FluxReduceStore","MessengerFluxReduceDispatcher","MessengerSharedMediaActions","MessengerSharedMediaReducer","MessengerSharedMediaState"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=Object.keys(b("MessengerSharedMediaReducer"));g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return new(b("MessengerSharedMediaState"))()};a.prototype.reduce=function(a,c){if(c.namespace!==b("MessengerSharedMediaActions").Namespace)return a;h.forEach(function(d){a=b("MessengerSharedMediaReducer")[d](a,c)});return a};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MessengerFluxReduceDispatcher"))}),null);
__d("MessengerSharedPhotosAlbumViewPhotoReact.bs",["bs_curry","React","cssURL","ReasonReact.bs"],(function(a,b,c,d,e,f){"use strict";var g=b("ReasonReact.bs").statelessComponent("MessengerSharedPhotosAlbumViewPhotoReact");function a(a,c,d,e,f){return[g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],function(){return b("React").createElement("a",{className:a,style:{backgroundImage:b("cssURL")(e)},href:"#",onClick:function(){return b("bs_curry")._1(d,c)}},f)},g[9],g[10],g[11],g[12]]}f.component=g;f.make=a}),null);
__d("MessengerSharedPhotosAlbumViewVScrollReact.bs",["cx","bs_array","bs_curry","React","bs_string","ReactDOM","Animation","bs_caml_array","ReasonReact.bs","bs_caml_builtin_exceptions","MessengerSharedMediaActions","MessengerSharedPhotosAlbumViewPhotoReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function h(a){var c=a[1],d=c.length;if(d<48){b("MessengerSharedMediaActions").loadMorePrevious(a[0],b("bs_caml_array").caml_array_get(c,c.length-1|0).cursor,48);return 0}else return 0}function i(a){if(a){a=a[0];return(a.scrollTop+a.clientHeight|0)>=(a.scrollHeight-20|0)}else throw b("bs_caml_builtin_exceptions").not_found}function j(a){if(a)return a[0].scrollTop<=20;else throw b("bs_caml_builtin_exceptions").not_found}function k(a){if(a)return a[0].clientHeight;else throw b("bs_caml_builtin_exceptions").not_found}function l(a,c){if(a){new(b("Animation"))(a[0]).to("scrollTop",c).duration(200).go();return 0}else return 0}function m(a){var c=a[2][0];if(c)return l(a[1][0],b("ReactDOM").findDOMNode(c[0]).offsetTop-70|0);else return 0}function n(a,c){__p&&__p();a=c[2];var d=a[3],e=a[1],f=a[0];c=c[1];var g=e.length;if(i(c[1][0]))if(g<a[2]&&!d.prev){b("MessengerSharedMediaActions").loadMorePrevious(f,b("bs_caml_array").caml_array_get(e,e.length-1|0).cursor,48);return 0}else return 0;else if(j(c[1][0])&&!d.latest){b("MessengerSharedMediaActions").loadMoreLatest(f,b("bs_caml_array").caml_array_get(e,0).cursor,48);return 0}else return 0}function o(a){__p&&__p();var c=a[1],d=c[1][0];if(d){var e=b("bs_curry")._1(a[0],n);d[0].addEventListener("scroll",e);b("bs_curry")._1(a[4],function(){var a=c[1][0];if(a)return a[0].removeEventListener("scroll",e);else return 0})}h(a[2]);d=function(){__p&&__p();if(k(c[3][0])>0){m(c);var a=c[0][0];if(a){clearInterval(a[0]);c[0][0]=0;return 0}else return 0}else return 0};c[0][0]=[setInterval(d,200)];return 0}function p(a){a=a[1][0][0];if(a){clearInterval(a[0]);return 0}else return 0}var q=b("ReasonReact.bs").reducerComponentWithRetainedProps("MessengerSharedPhotosAlbumViewVScrollReact");function r(a,b){b[1][1][0]=a==null?0:[a];return 0}function s(a,b){b[1][3][0]=a==null?0:[a];return 0}function t(a,b){b[1][2][0]=a==null?0:[a];return 0}function u(a,c,d,e,f,g,h){__p&&__p();var i=function(a){__p&&__p();return b("bs_array").map(function(d){__p&&__p();d=d.node;var e=d.photo_encodings;e=e==null?!1:e.length!==0;var f=d.photo_encodings;if(e&&!(f==null)){f=f.find(function(a){return a.projection_type==="perspective"});if(f!==undefined&&f.thumbnails.length!==0){f=f.thumbnails;f=b("bs_caml_array").caml_array_get(f,0).uri}else f=d.image1.uri}else f=d.image1.uri;var h=d.legacy_attachment_id===g;return b("ReasonReact.bs").element([d.legacy_attachment_id],h?[b("bs_curry")._1(a[0],t)]:0,b("MessengerSharedPhotosAlbumViewPhotoReact.bs").make("_3bly"+(e?" _3603":""),d.legacy_attachment_id,c,f,[b("React").createElement("div",{key:b("bs_string").concat("_",[d.legacy_attachment_id,["spherical_gradient",0]]),className:e?"_64ks":""})]))},d)};return[q[0],q[1],q[2],q[3],o,q[5],p,q[7],function(a){return b("React").createElement("div",{ref:b("bs_curry")._1(a[0],r),className:"_3xo8",onScroll:b("bs_curry")._1(a[0],n)},b("React").createElement("div",{ref:b("bs_curry")._1(a[0],s),className:"_3xoa"},i(a)))},function(){return[[0],[0],[0],[0]]},[e,d,f,a],function(a,b){return 0},q[12]]}a=b("ReasonReact.bs").wrapReasonForJs(q,function(a){return u(a.isLoading,a.onClick,a.sharedPhotos,a.threadID,a.totalCount,a.viewedPhoto,[])});c=200;d=48;e=6;g=20;var v=70;f.animationDuration=c;f.imagesToLoad=d;f.photosPerRow=e;f.scrollToEdgeTolerance=g;f.headerHeight=v;f.graduallyLoadPhotos=h;f.isScrolledToBottom=i;f.isScrolledToTop=j;f.getScrollHeight=k;f.scrollTo=l;f.autoScrollWhenLoaded=m;f.handleScroll=n;f.didMount=o;f.willUnmount=p;f.component=q;f.setRefChildContainer=r;f.setRefScrollable=s;f.setRefChild=t;f.make=u;f.jsComponent=a}),null);
__d("MessengerSharedPhotosAlbumView.react",["cx","fbt","MessengerPhotoViewCloseLink.react","MessengerSharedPhotosAlbumViewVScrollReact.bs","React","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MessengerSharedPhotosAlbumViewVScrollReact.bs").jsComponent;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$2=function(){this.props.onClick(this.props.viewedPhoto)}.bind(this),b}a.prototype.render=function(){return b("React").createElement("div",{className:"_3bl- _5l-3",ref:"window"},this.$1(),b("React").createElement(j,{isLoading:this.props.isLoading,onClick:this.props.onClick,sharedPhotos:this.props.sharedPhotos,threadID:this.props.threadID,totalCount:this.props.totalCount,viewedPhoto:this.props.viewedPhoto}))};a.prototype.$1=function(){return b("React").createElement("div",{className:"_3bm0 _5l-3",ref:"header"},b("React").createElement(b("ShimButton.react"),{className:"_3bm2",onClick:this.$2},b("React").createElement("div",{className:"_3bm3"}),h._("Back to photo")),b("React").createElement("div",{className:"_3bm4"},h._("Shared Photos")),b("React").createElement(b("MessengerPhotoViewCloseLink.react"),{onClick:this.props.onCloseSharedPhotos}))};a.propTypes={onClick:c.func.isRequired,onCloseSharedPhotos:c.func.isRequired,sharedPhotos:c.arrayOf(c.object).isRequired,totalCount:c.number.isRequired,viewedPhoto:c.string.isRequired,threadID:c.string.isRequired,isLoading:c.object.isRequired};e.exports=a}),null);
__d("MessengerSharedPhotosAlbumViewContainer.react",["FluxContainer","MessengerSharedMediaStore","MessengerSharedPhotosAlbumView.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);g=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.state={edges:[],count:0,isLoading:{}},b}a.getStores=function(){return[b("MessengerSharedMediaStore")]};a.calculateState=function(a,c){a=b("MessengerSharedMediaStore").getState();var d=a.sharedMedia;return{edges:d.get(c.threadID).edges,count:d.get(c.threadID).count,isLoading:a.isLoading.get(c.threadID)}};a.prototype.render=function(){return this.state.edges.length===0?null:b("React").createElement(b("MessengerSharedPhotosAlbumView.react"),{onClick:this.props.onClick,onCloseSharedPhotos:this.props.onCloseSharedPhotos,sharedPhotos:this.state.edges,totalCount:this.state.count,viewedPhoto:this.props.viewedPhoto,threadID:this.props.threadID,isLoading:this.state.isLoading})};a.propTypes={onClick:c.func.isRequired,onCloseSharedPhotos:c.func.isRequired,viewedPhoto:c.string.isRequired,threadID:c.string};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("SpotlightMessengerSharedMediaViewerContainer.react",["FluxContainer","MessengerSharedMediaActions","MessengerSharedMediaStore","React","SpotlightMessengerSharedMediaViewer.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MessengerSharedMediaStore")]};a.calculateState=function(a,c){a=b("MessengerSharedMediaStore").getState();var d=a.sharedMedia.get(c.threadID);a=a.isLoading.get(c.threadID);return{sharedMedia:d,isLoading:a}};a.prototype.componentDidMount=function(){b("MessengerSharedMediaActions").loadCurrent(this.props.threadID,this.props.photoID)};a.prototype.render=function(){if(!this.state.sharedMedia)return null;var a=this.state.sharedMedia&&this.state.sharedMedia.edges.find(function(a){return a.node.legacy_attachment_id===this.props.photoID}.bind(this));return!a?null:b("React").createElement(b("SpotlightMessengerSharedMediaViewer.react"),{disableForward:this.props.disableForward,hasPrevPage:this.state.sharedMedia&&this.state.sharedMedia.has_previous_page,hasNextPage:this.state.sharedMedia&&this.state.sharedMedia.has_next_page,onClosePhotoView:this.props.onClosePhotoView,openAlbum:this.props.openAlbum,photoID:this.props.photoID,rootClassName:this.props.rootClassName,sharedMedia:this.state.sharedMedia&&this.state.sharedMedia.edges,threadID:this.props.threadID})};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MessengerThreadSharedPhotos.react",["cx","MessengerSharedPhotosAlbumViewContainer.react","React","SpotlightMessengerSharedMediaViewerContainer.react","SpotlightViewer"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={photoView:this.props.findFBID,albumView:""},this.$3=function(a){this.setState({albumView:a,photoView:""})}.bind(this),this.$4=function(){this.setState({albumView:""})}.bind(this),this.$5=function(a){this.setState({albumView:"",photoView:a})}.bind(this),this.$6=function(){this.setState({photoView:""})}.bind(this),this.$7=function(a){this.setState({photoView:a})}.bind(this),b}a.prototype.componentDidUpdate=function(){!this.state.photoView&&!this.state.albumView&&this.props.onCloseSharedPhotos()};a.prototype.render=function(){var a=this.state.photoView?this.$1():null,c=this.state.albumView?this.$2():null;return b("React").createElement("div",null,c,a)};a.prototype.$1=function(){return b("React").createElement(b("SpotlightMessengerSharedMediaViewerContainer.react"),{disableForward:!1,onClosePhotoView:this.$6,openAlbum:this.$3,photoID:this.state.photoView,rootClassName:"",threadID:this.props.threadFBID})};a.prototype.$2=function(){return b("React").createElement(b("SpotlightViewer"),{className:"_3ode",onHide:this.$4,open:!0,ref:"spotlightViewer"},b("React").createElement(b("MessengerSharedPhotosAlbumViewContainer.react"),{onClick:this.$5,onCloseSharedPhotos:this.props.onCloseSharedPhotos,threadID:this.props.threadFBID,viewedPhoto:this.state.albumView}))};a.propTypes={findFBID:c.string,onCloseSharedPhotos:c.func,threadFBID:c.string};e.exports=a}),null);
__d("MessengerThreadSharedPhotosReact.bs",["ReasonReact.bs","MessengerThreadSharedPhotos.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e){return b("ReasonReact.bs").wrapJsForReason(b("MessengerThreadSharedPhotos.react"),{findFBID:a,onCloseSharedPhotos:c,threadFBID:d},e)}f.make=a}),null);
__d("MessengerVideoPlayerReact.bs",["ReasonReact.bs","bs_js_null_undefined","MessengerVideoPlayer.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g,h,i,j,k){return b("ReasonReact.bs").wrapJsForReason(b("MessengerVideoPlayer.react"),{attachment:b("bs_js_null_undefined").fromOption(a),className:b("bs_js_null_undefined").fromOption(c),isInThread:b("bs_js_null_undefined").fromOption(d),isVisible:b("bs_js_null_undefined").fromOption(e),isOnStage:b("bs_js_null_undefined").fromOption(f),stageDimensions:b("bs_js_null_undefined").fromOption(g),videoData:h,onClick:b("bs_js_null_undefined").fromOption(i),onSelect:b("bs_js_null_undefined").fromOption(j)},k)}f.make=a}),null);
__d("MessengerVideoReact.bs",["cx","ix","bs_curry","React","ImageReact.bs","ReasonReact.bs","joinClasses","bs_js_primitive","MessengerPhotoReact.bs","MessengerVideoPlayerReact.bs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("ReasonReact.bs").statelessComponent("MessengerVideo");function j(a){__p&&__p();a=a.metadata;var b;if(a==null||a.fbid==null)b=1;else{var c=window.screen.width>1800&&!(a.large_size==null)&&!(a.large_preview==null),d=a.fbid,e=c?a.large_size:a.inbox_size;e=e==null?{x:0,y:0}:{x:e.width,y:e.height};c=c?a.large_preview:a.inbox_preview;return{legacy_attachment_id:d,original_dimensions:e,start_muted:!0,hide_controls_on_finish:!0,url:c,is_share:!1}}if(b===1)return{legacy_attachment_id:null,original_dimensions:null,start_muted:!0,hide_controls_on_finish:!0,url:null,is_share:!1}}function k(a){var b=a%60,c=b<10;return String(a/60|0)+(":"+((c?"0":"")+String(b)))}function a(a,c,d,e,f,g,l,m){__p&&__p();var n=a?a[0]:"",o=function(){var a=c.metadata,d=c.media;d=a==null?d==null?0:b("bs_js_primitive").null_undefined_to_opt(d.duration):b("bs_js_primitive").null_undefined_to_opt(a.duration);if(d)return k(d[0]);else return null},p=function(){if(g)return b("bs_curry")._1(g[0],c);else return 0},q=function(a){var e=a.legacy_attachment_id;if(e==null)return 0;else return[b("ReasonReact.bs").element(0,0,b("MessengerVideoPlayerReact.bs").make([c],[b("joinClasses")(n,"_ccq","_4tsk","_3o67",d?"_52mr":"",d?"_1byr":"")],[!0],f,0,0,a,[p],l,[]))]};return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],function(){var a=j(c);a=q(a);if(a)return a[0];else return b("ReasonReact.bs").element(0,0,b("MessengerPhotoReact.bs").make([b("joinClasses")(n,"_ccq")],c,d,0,e,g,[b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make(["_ccr"],0,0,0,[h("27983")],0,0,0,0,[])),b("React").createElement("span",{className:"_ccs"},o(0))]))},i[9],i[10],i[11],i[12]]}c=1800;f.component=i;f.large_window_width=c;f.constructVideoData=j;f.formatDuration=k;f.make=a}),null);
__d("MessengerXMATextBlock.react",["cx","LineClamp.react","React","ShimButton.react","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;var i=26;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=function(){this.props.url&&window.open(this.props.url)}.bind(this),b}a.prototype.render=function(){if(!this.props)return b("React").createElement("div",{className:"__6j"});var a=this.props.width?{maxWidth:this.props.width-i,textAlign:"left"}:{textAlign:"left"},c={textDecoration:"none"};return b("React").createElement("div",{className:b("joinClasses")(this.props.className,"__6j _43kk"),style:a},b("React").createElement(b("ShimButton.react"),{form:"link",onClick:this.$1,style:c},this.renderTitle(),this.renderDescription(),this.renderSource()))};a.prototype.renderTitle=function(){return!this.props.title?null:b("React").createElement("div",{className:"__6k"},b("React").createElement(b("LineClamp.react"),{lines:2,lineHeight:16},this.props.title))};a.prototype.renderDescription=function(){if(!this.props.description)return null;var a=this.props.width?{maxWidth:this.props.width-i}:{};return b("React").createElement("div",{className:"__6l",style:a},b("React").createElement(b("LineClamp.react"),{lines:2,lineHeight:15},this.props.description))};a.prototype.renderSource=function(){return!this.props.source?null:b("React").createElement("div",{className:"__6m"},b("React").createElement(b("LineClamp.react"),{lines:1,lineHeight:14},this.props.source))};a.propTypes={className:c.string,description:c.string,source:c.string,title:c.string,url:c.string,width:c.number};e.exports=a}),null);
__d("MessengerXMATextBlockReact.bs",["ReasonReact.bs","bs_js_null_undefined","MessengerXMATextBlock.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g,h){return b("ReasonReact.bs").wrapJsForReason(b("MessengerXMATextBlock.react"),{className:b("bs_js_null_undefined").fromOption(a),description:b("bs_js_null_undefined").fromOption(c),source:b("bs_js_null_undefined").fromOption(d),title:b("bs_js_null_undefined").fromOption(e),url:b("bs_js_null_undefined").fromOption(f),width:b("bs_js_null_undefined").fromOption(g)},h)}f.make=a}),null);
__d("MessengerVideoXMAReact.bs",["cx","React","ReasonReact.bs","joinClasses","bs_js_primitive","MessengerVideoPlayerReact.bs","MessengerXMATextBlockReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ReasonReact.bs").statelessComponent("MessengerVideoXMA");function i(a){__p&&__p();if(a==null)return null;else{var b=a.width>a.height?a.width:a.height,c=window.screen.width>1800;c=c?640:450;if(b<=c)return{x:a.width,y:a.height};else{c=c/b;b=a.width*c|0;a=a.height*c|0;return{x:b,y:a}}}}function j(a){var b=a.media;a=a.target;if(b==null||a==null||b.image_size==null||a.video_id==null)return 0;else{var c=b.image_size;return[{legacy_attachment_id:a.video_id,original_dimensions:i(c),start_muted:!0,hide_controls_on_finish:!0,url:b.image,is_share:!0}]}}function a(a,c,d,e,f){var g=a?a[0]:"",i=function(a){if(a)return b("ReasonReact.bs").element(0,0,b("MessengerVideoPlayerReact.bs").make([c],[b("joinClasses")(g,"_ccq","_4tsk","_3o67","_52mr","_1byr")],[!0],d,0,0,a[0],0,e,[]));else return null},k=function(a){return b("ReasonReact.bs").element(0,0,b("MessengerXMATextBlockReact.bs").make(["_2f5n _4br2 _29ew _3dug"],b("bs_js_primitive").null_undefined_to_opt(c.description),b("bs_js_primitive").null_undefined_to_opt(c.source),b("bs_js_primitive").null_undefined_to_opt(c.video_title),b("bs_js_primitive").null_undefined_to_opt(c.uri),a?[a[0].x]:0,[]))};return[h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],function(){var a=j(c),d=i(a);return b("React").createElement("div",{className:"_3duc"},d,k(a?b("bs_js_primitive").null_undefined_to_opt(a[0].original_dimensions):0))},h[9],h[10],h[11],h[12]]}c=640;d=450;e=1800;f.large_preview_dim=c;f.thumbinail_inbox_dim=d;f.large_window_width=e;f.component=h;f.adjustSize=i;f.constructVideoData=j;f.make=a}),null);
__d("MessengerPhotosGroupReact.bs",["cx","URI","bs_block","bs_curry","React","Utils.bs","ActorURI","bs_belt_Array","LogHistory","MercuryIDs","ReasonReact.bs","joinClasses","bs_js_primitive","bs_caml_primitive","bs_js_null_undefined","MessagesViewerSetID","MessengerPhotoReact.bs","MessengerVideoReact.bs","MercuryAttachmentType","getPageIDFromThreadID","MessengerVideoXMAReact.bs","bs_caml_builtin_exceptions","ChatSpeakingStickerReact.bs","MercuryAttachmentPayload.bs","MessengerAttachmentViewer","MessengerThreadSharedPhotosReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h="empty-spacer",i=b("LogHistory").getInstance("messenger_photo_group"),j=b("ReasonReact.bs").reducerComponent("MessengerPhotosGroup");function k(a,c,d,e,f,g,k,l,m,n,o,p){__p&&__p();var q=d?d[0]:"",r=function(a){a=a.length;var c=a===2||a===4;return b("joinClasses")(q,"_2n8h",a===1?"_2n8i":"",c?"_4ksk":"",a>1&&!c?"_2n8k":"","_5fk1")},s=function(){__p&&__p();if(l){var a=l[0],c=a.thread_fbid;if(c==null)return b("MercuryIDs").getThreadFBIDFromThreadID(a.thread_id);else{var d=b("bs_caml_primitive").caml_string_compare(c,"")===0;if(d)return b("MercuryIDs").getThreadFBIDFromThreadID(a.thread_id);else return c}}else return null},t=function(a,c){var d=s(0);c=c.metadata;c=c==null?null:c.fbid;return b("ReasonReact.bs").element(0,0,b("MessengerThreadSharedPhotosReact.bs").make(c,function(){return b("bs_curry")._1(a[3],0)},d,[]))},u=function(a){a=JSON.stringify(a);if(a!==undefined)return a;else return""},v=function(d,j,l,q){__p&&__p();var r=j.deduplication_key,t=j.metadata;if(r==null)if(t==null){var v=j.upload_id;v=v==null?"":v}else{t=t.fbid;v=t==null?"":t}else v=r;var w=function(b,a){i.debug("just_open_uri",u(j));return window.open(b)},x;if(!l&&!b("Utils.bs").isSomeTrue(f)){var y=j.metadata;t=0;if(y==null||y.fbid==null)t=1;else{r=j.app_attribution==null;x=r?[function(a){i.debug("open_share_view",u(a));return b("bs_curry")._1(d[3],[a])}]:[function(c){__p&&__p();var d=y;c=c;i.debug("on_child_clicked",u(c));if(b("Utils.bs").isTruthy(c.preview_uploading))return 0;else if(c.attach_type===b("MercuryAttachmentType").VIDEO){var f=d.dimensions;f=f==null?{x:null,y:null}:{x:f.width,y:f.height};b("MessengerAttachmentViewer").renderVideo({pageID:b("bs_js_null_undefined").fromOption(o),rootClassName:"_1j1h",videoID:d.fbid,videoSize:f,videoURI:c.url});return 0}else if(c.attach_type===b("MercuryAttachmentType").PHOTO||c.attach_type===b("MercuryAttachmentType").THIRDPARTYSTICKER||c.attach_type===b("MercuryAttachmentType").ANIMATED_IMAGE){f=a.length===1;var h=c.url;if(!b("Utils.bs").isSomeTrue(g)&&c.attach_type===b("MercuryAttachmentType").PHOTO&&e!==0){var j=s(0),k=e===[1];j=new(b("URI"))("/ajax/messaging/attachments/sharedphotos.php").setQueryData({thread_id:j,image_id:d.fbid});j=o?new(b("ActorURI").create)(j,o[0]):j;j=[b("MessagesViewerSetID").MESSAGES_VIEW_ALL_IN_THREAD,j,k]}else j=[null,h,f];b("MessengerAttachmentViewer").bootstrapWithConfig({actorid:b("bs_js_null_undefined").fromOption(o),dimensions:d.dimensions,disableForward:o!==0,disablePaging:j[2],endpoint:j[1],fbid:d.fbid,rootClassName:"_1j1h",setID:j[0],snapToPhoto:!0,src:c.preview_url});return 0}else if(c.uri==null)return 0;else return window.open(c.uri)}]}if(t===1){l=j.uri==null;if(l)x=0;else{var z=j.uri;x=[function(a){return w(z,a)}]}}}else{r=j.large_preview_url==null;if(r)x=0;else{var A=j.large_preview_url;x=[function(a){return w(A,a)}]}}t=b("Utils.bs").$pipe$unknown(c,j.attach_type);if(t===b("MercuryAttachmentType").PHOTO||t===b("MercuryAttachmentType").ANIMATED_IMAGE||t===b("MercuryAttachmentType").THIRDPARTYSTICKER)return b("ReasonReact.bs").element([v],0,b("MessengerPhotoReact.bs").make(0,j,q,k,m,x,[]));else if(t===b("MercuryAttachmentType").VIDEO){l=j.metadata;if(l==null||!b("Utils.bs").isTruthy(l.render_as_sticker))r=1;else{l=l.dimensions;l=l==null?{height:null,width:null}:{height:l.height,width:l.width};var B=j.url;return b("ReasonReact.bs").element(0,0,b("ChatSpeakingStickerReact.bs").make(B,l,[]))}if(r===1)if(b("Utils.bs").isSomeTrue(g))return b("ReasonReact.bs").element([v],0,b("MessengerVideoXMAReact.bs").make(0,j,k,n,[]));else return b("ReasonReact.bs").element([v],0,b("MessengerVideoReact.bs").make(0,j,q,m,k,x,n,[]))}else if(t===h){B={className:"_4tsk _4rf-"};l=b("bs_js_primitive").null_undefined_to_opt(j.key);l&&(B.key=l[0]);return b("React").createElement("div",B)}else throw[b("bs_caml_builtin_exceptions").invalid_argument,t+" is not handled by MessengerPhotosGroup"]},w=function(c,a,d){__p&&__p();if(a.length!==1){var e=a.length===2||a.length===4,f=e?2:3;e=[];var g=[0],i=a.length;while(g[0]<i){var j=b("bs_caml_primitive").caml_int_min(f,i-g[0]|0);j=b("bs_belt_Array").makeBy(f,function(e){return function(j){var i=j<e;if(i)return v(c,a[g[0]+j|0],d,!1);else{i="ghost"+String(f-j|0);j=b("MercuryAttachmentPayload.bs").create(h,[i],new(b("URI"))(""));return v(c,j,d,!1)}}}(j));e.push(b("React").createElement("div",{key:String(g[0]),className:"_2n8g"},j));g[0]=g[0]+f|0}return e}else{j=a[0];return v(c,j,d,!0)}};return[j[0],j[1],j[2],j[3],function(){b("MessengerAttachmentViewer").preload();return 0},j[5],j[6],j[7],function(c){var d=l?!(b("getPageIDFromThreadID")(l[0].thread_id)==null):!1;d=w(c,a,d);var e=c[1][0];c=e?t(c,e[0]):null;return b("React").createElement("div",{className:r(a),tabIndex:0},c,d)},function(){return[0]},j[10],function(c,a){if(c)return b("bs_block").__(0,[[[c[0]]]]);else return b("bs_block").__(0,[[0]])},j[12]]}a=b("ReasonReact.bs").wrapReasonForJs(j,function(a){return k(a.attachments,b("bs_js_primitive").null_undefined_to_opt(a.attachType),b("bs_js_primitive").null_undefined_to_opt(a.className),b("bs_js_primitive").null_undefined_to_opt(a.count),b("bs_js_primitive").null_undefined_to_opt(a.isPageMessage),b("bs_js_primitive").null_undefined_to_opt(a.isXMA),b("bs_js_primitive").null_undefined_to_opt(a.isVisible),b("bs_js_primitive").null_undefined_to_opt(a.message),b("bs_js_primitive").null_undefined_to_opt(a.onAttachmentLoad),b("bs_js_primitive").null_undefined_to_opt(a.onSelect),b("bs_js_primitive").null_undefined_to_opt(a.pageID),[])});f.empty_spacer_type=h;f.history=i;f.component=j;f.make=k;f.jsComponent=a}),null);
__d("MessengerPhotosGroup.react",["MessengerPhotosGroupReact.bs"],(function(a,b,c,d,e,f){"use strict";a=b("MessengerPhotosGroupReact.bs").jsComponent;e.exports=a}),null);