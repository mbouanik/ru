if (self.CavalryLogger) { CavalryLogger.start_js(["alxUa"]); }

__d("MessengerThreadlistRow.react",["cx","fbt","ix","Bootloader","CurrentUser","FBRTCCore","FBRTCLogger","Image.react","ImmutableObject","LinkWithHiddenURLBar.react","MercuryIDs","MercuryIgnoredBlockedParticipants.bs","MercuryParticipantListRenderer","MercuryThreadActions","MercuryThreadSnippet.react","MercuryThreadTimestampReact.bs","MercuryThreadTitle.react","MercuryTimestamp","MessagingTag","MessengerActions","MessengerAdminGroupUtils","MessengerButtonReact.bs","MessengerDialogs.bs","MessengerMessage.bs","MessengerMessageRequestsTypedLogger","MessengerParticipants.bs","MessengerPresenceStatusUtils","MessengerThreadImageReact.bs","MessengerThreadlistRowActionsReact.bs","MessengerThreadlistRowSeenHeadReact.bs","MessengerURIStore","MessengerURIUtils.bs","MNAdsMessageUtils","React","ReactDOM","RTCCallState","RTWebLoggingCallType","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","Tooltip","UserAgent","asset","getPageIDFromThreadID","gkx","immutable","joinClasses","messengerRTLClasses"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("FBRTCLogger").Trigger,l=b("MercuryThreadTimestampReact.bs").jsComponent,m=b("MessengerButtonReact.bs").jsComponent,n=b("MessengerThreadImageReact.bs").jsComponent,o=b("MessengerThreadlistRowActionsReact.bs").jsComponent,p=b("MessengerThreadlistRowSeenHeadReact.bs").jsComponent;c=b("React").PropTypes;var q=50,r=i("86913"),s=i("86914"),t=function(a){var b;switch(a){case"pending":case"other":case"inbox":case"thread":b=a;break;default:b=null}return b};d=babelHelpers.inherits(a,b("React").PureComponent);j=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.state={actionsOpen:!1,participantNames:""},this.$1=0,this.$2=null,this.$16=function(){__p&&__p();var a=b("CurrentUser").getID();a=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.thread.thread_id,a);b("MercuryThreadActions").get()["delete"](this.props.thread.thread_id);this.props.isActive&&b("MessengerActions").selectThread(null);if(this.props.showAggregation){var c=b("MessengerURIStore").getState().threadIDs;if(c){c=c.filter(function(a){return this.props.thread.thread_id!==a}.bind(this));b("MessengerActions").selectAggregation(c)}}new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_delete_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.thread.thread_id)).setSurface(t(this.props.folder)).setFolderType("pending").setThreadKey(a).setEntryPoint("inbox_banner").log()}.bind(this),this.$17=function(a){var c=b("CurrentUser").getID();c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.thread.thread_id,c);a||(b("MessengerDialogs.bs").removeDialog(),new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_cancel").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.thread.thread_id)).setSurface(t(this.props.folder)).setFolderType("pending").setThreadKey(c).setEntryPoint("inbox_banner").log())}.bind(this),this.$4=function(a){a.preventDefault(),this.props.onFocus(this.props.thread.thread_id)}.bind(this),this.$5=function(a){this.$1++;if(this.$2)return;this.$2=setTimeout(function(){this.props.onSelect&&this.props.onSelect(),this.$1=0,this.$2=null}.bind(this),1e3)}.bind(this),this.$6=function(a){this.$1--,this.$1===0&&(clearTimeout(this.$2),this.$2=null)}.bind(this),this.$8=function(a){this.props.onSelect()}.bind(this),this.$9=function(a){if(this.props.logClickHandler){a=this.props.thread.is_canonical?b("MercuryIDs").getUserIDFromThreadID(this.props.thread.thread_id)||"0":this.props.thread.thread_fbid;this.props.logClickHandler&&this.props.logClickHandler(a)}}.bind(this),this.$15=function(a){this.setState({actionsOpen:a})}.bind(this),this.$18=function(a){__p&&__p();a.preventDefault();a.stopPropagation();a=window.callWindow&&!window.callWindow.closed&&window.callWindow.focus;if(a)window.callWindow.focus();else{a=this.props.thread;var c=a.rtc_call_data;a=a.thread_fbid;a="GROUP:"+a;var d=c.call_state===b("RTCCallState").VIDEO_GROUP_CALL;b("RTWebUserActionLogger").logClick({callType:b("RTWebLoggingCallType").MW,component:b("RTWebLoggingComponent").JOIN_CALL,conferenceName:a,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").THREAD_LIST,mediaType:b("RTWebUserActionLogger").getMediaType(!d)});b("FBRTCCore").startGroupCall({conferenceName:a,hasVideo:d,serverInfoData:c.server_info_data,trigger:k.MULTIWAY_THREAD_LIST_JOIN_CALL_BUTTON})}}.bind(this),c}a.prototype.componentDidMount=function(){this.getParticipantNames()};a.prototype.componentDidUpdate=function(a){__p&&__p();this.props.isFocused&&(!a.isFocused?this.props.isActionsFocused?b("ReactDOM").findDOMNode(this.refs.actions.refs.button).focus():b("ReactDOM").findDOMNode(this.refs.link).focus():!a.isActionsFocused&&this.props.isActionsFocused?b("ReactDOM").findDOMNode(this.refs.actions.refs.button).focus():a.isActionsFocused&&!this.props.isActionsFocused&&b("ReactDOM").findDOMNode(this.refs.link).focus());if(this.$3(this.props.thread)&&!this.$3(a.thread)){a=this.props.thread;var c=a.rtc_call_data;a=a.thread_fbid;a="GROUP:"+a;c=c.call_state===b("RTCCallState").VIDEO_GROUP_CALL;b("RTWebUserActionLogger").logImpression({callType:b("RTWebLoggingCallType").MW,component:b("RTWebLoggingComponent").JOIN_CALL,conferenceName:a,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").THREAD_LIST,mediaType:b("RTWebUserActionLogger").getMediaType(!c)})}this.getParticipantNames()};a.prototype.getParticipantNames=function(){__p&&__p();if(this.state.participantNames!=="")return;var a=this.props,c=a.thread;a=a.viewer;var d=c.participants||[],e=b("MercuryIDs").getParticipantIDFromUserID(a);d.length>1&&(d=d.filter(function(a){return a!=e}));var f=c.custom_nickname?{}:null;if(f)for(var g in c.custom_nickname)f[g]=c.custom_nickname[g];b("MessengerParticipants.bs").getMulti(d,function(a){var c=d.map(function(b){return a[b]});c=new(b("MercuryParticipantListRenderer"))().setNickname(f).renderParticipantList(c);this.setState({participantNames:c})}.bind(this))};a.prototype.render=function(){var a=this.props,c=a.isActive,d=a.isActionsFocused,e=a.isTabbable,f=a.participants,g=a.thread;a=a.viewer;var i=g.unread_count>0,j=b("MessengerURIUtils.bs").getURIForThreadID(g.thread_id),k=g.name?g.name:this.state.participantNames;return b("React").createElement("li",{"aria-live":i?"polite":null,"aria-relevant":c||i?"additions text":null,onFocus:this.$4,className:"_5l-3 _1ht1"+(g.folder===b("MessagingTag").PENDING?" _4as3":"")+(this.props.isActive?" _1ht2":"")+(i?" _1ht3":"")+(this.state.actionsOpen?" _13aa":"")+(this.props.isMuted?" _569x":"")+(b("gkx")("AT4P8EeNU5psOznhIbc1cKhXCwNU-1iAmabZ7iBm-dOcgmsCEibyLc1ZZsOZGGQul_RlmIVlMxa-s5x-yiJ5uaFE")&&g.is_pinned?" _1oh3":"")+(this.props.isFocused?" _23_m":"")+(i&&b("UserAgent").isBrowser("Chrome")&&b("UserAgent").isPlatform("Mac")?" _5fx8":""),onDragEnter:c?null:this.$5,onDragLeave:c?null:this.$6,role:"row",ref:function(a){return a&&this.props.registerThreadRefs&&this.props.registerThreadRefs(a)}.bind(this),tabIndex:-1},b("React").createElement("div",{className:"_5l-3 _1ht5",id:this.$7(g.thread_id),role:"gridcell",tabIndex:-1},b("React").createElement(b("LinkWithHiddenURLBar.react"),{href:j.toString(),onClick:this.$8,onAllClicks:this.$9,className:"_1ht5 _2il3 _5l-3 _3itx",s:"true",ref:"link",role:"link",tabIndex:e&&!d?0:-1},this.props.isMuted&&b("React").createElement("div",{className:"accessible_elem"},h._("muted conversation")),b("React").createElement("div",babelHelpers["extends"]({},b("Tooltip").propsFor(k,"right","center"),{"data-tooltip-root-class":"_33g_","aria-hidden":!0,className:"_1qt3 _5l-3"}),b("React").createElement(n,{isPresenceForWork:this.props.isPresenceForWork,isDoNotDisturb:this.props.isDoNotDisturb,participants:f,size:q,thread:g,viewer:a})),b("React").createElement("div",{className:"_1qt4 _5l-m"},b("React").createElement("div",{className:"_1qt5 _5l-3"},b("React").createElement(b("MercuryThreadTitle.react"),{className:"_1ht6",showUnreadCount:!1,thread:g,useShortName:!1,viewer:a}),b("React").createElement("div",null,b("MNAdsMessageUtils").isAdsMessageRequest(g)?b("MNAdsMessageUtils").renderAdsMessageRequestStatus():this.$10(g))),b("React").createElement("div",{className:"_1qt5 _5l-3"},b("React").createElement(b("MercuryThreadSnippet.react"),{className:b("joinClasses")("_1htf",b("messengerRTLClasses")(g.snippet,!0)),participants:f,shouldRenderYou:!0,thread:g,viewer:a})),this.$11(),this.$12()))),this.$13())};a.prototype.$13=function(){if(this.props.showActions===!1)return null;var a=this.props,c=a.blockedIds,d=a.isActionsFocused,e=a.isTabbable,f=a.participants,g=a.thread;a=a.viewer;var j=b("MessengerPresenceStatusUtils").getStatusFromCanonicalThread(this.props.participants,g);j=j&&j.contact;c=b("MercuryIgnoredBlockedParticipants.bs").qualifiesAs(a,c,g);var k=b("MessengerAdminGroupUtils").isJoinableThread(g),l=b("MercuryIDs").isGroupChat(this.props.thread.thread_id),m=g.unread_count>0;return b("React").createElement("div",{role:"gridcell"},b("React").createElement("div",{"aria-describedby":this.$7(g.thread_id),"aria-haspopup":"true","aria-label":h._("Actions"),className:"_2j6 _5l-3",tabIndex:e&&d?0:-1,role:"button"},b("CurrentUser").isWorkUser()&&b("gkx")("AT4P8EeNU5psOznhIbc1cKhXCwNU-1iAmabZ7iBm-dOcgmsCEibyLc1ZZsOZGGQul_RlmIVlMxa-s5x-yiJ5uaFE")?b("React").createElement(b("Image.react"),{src:i("572538"),className:"_1oh5"}):null,b("React").createElement("div",{className:"_56ck"}),b("React").createElement(p,{className:"_5bli",isHidden:this.state.actionsOpen&&!(b("CurrentUser").isWorkUser()&&b("gkx")("AT4P8EeNU5psOznhIbc1cKhXCwNU-1iAmabZ7iBm-dOcgmsCEibyLc1ZZsOZGGQul_RlmIVlMxa-s5x-yiJ5uaFE")),lastMessage:this.props.lastMessage,participants:f,readReceipts:this.props.readReceipts,thread:g,viewer:a}),this.$14(),b("React").createElement(o,{contact:j,isGroupChat:l,isJoinableThread:k,isMuted:this.props.isMuted,isOpen:this.state.actionsOpen,isPinned:g.is_pinned,isUnread:m,isBlocked:c,onArchive:this.props.onArchive,onDelete:this.props.onDelete,onLeaveGroup:this.props.onLeaveGroup,onMarkRead:this.props.onMarkRead,onMarkSpam:this.props.onMarkSpam,onMarkUnread:this.props.onMarkUnread,onMute:this.props.onMute,onPin:this.props.onPin,onToggle:this.$15,onUnmute:this.props.onUnmute,onUnpin:this.props.onUnpin,onIgnore:this.props.onIgnore,onBlock:this.props.onBlock,onUnblock:this.props.onUnblock,showLeaveGroup:this.props.showLeaveGroup,showMute:!0,showBlock:g.is_canonical_user&&g.other_user_fbid&&a!==g.other_user_fbid,showReport:b("getPageIDFromThreadID")(this.props.thread.thread_id),tabIndex:-1,thread:g,ref:"actions"})))};a.prototype.$14=function(){var a=this.props.lastMessage;if(this.state.actionsOpen||!a)return null;var c=b("MessengerMessage.bs").isSending(a);a=b("MessengerMessage.bs").hasError(a);return!c&&!a?null:b("React").createElement(b("Image.react"),{className:"_wtw"+(c?" _3qh2":""),src:c?s:r})};a.prototype.$10=function(a){return b("React").createElement(l,{className:"_1ht7",time:a.timestamp,title:b("MercuryTimestamp").getAbsoluteTimestamp(a.timestamp),text:b("MercuryTimestamp").getRelativeTimestamp(a.timestamp)})};a.prototype.$11=function(){__p&&__p();if(this.props.thread.folder!==b("MessagingTag").PENDING)return null;var a=b("CurrentUser").getID(),c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.thread.thread_id,a);return b("React").createElement("div",{className:"_5l-3"},b("React").createElement(m,{className:"_3yvh",type:"primary",label:h._("Accept"),onClick:function(a){__p&&__p();a.preventDefault();a.stopPropagation();if(this.props.showAggregation){a=b("MessengerURIStore").getState().threadIDs;if(a){a=a.filter(function(a){return this.props.thread.thread_id!==a}.bind(this));b("MessengerActions").selectAggregation(a)}}b("MercuryThreadActions").get().changeFolder(this.props.thread.thread_id,b("MessagingTag").INBOX);new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_accept_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.thread.thread_id)).setSurface(t(this.props.folder)).setFolderType("pending").setThreadKey(c).setEntryPoint("inbox_banner").log()}.bind(this)}),b("React").createElement(m,{className:"_3yvh _1d-z",type:"faded",label:h._("Decline"),onClick:function(a){a.preventDefault(),a.stopPropagation(),b("Bootloader").loadModules(["MessengerDeclineDialogReact.bs"],function(a){var d=a.jsComponent,e=b("MercuryIDs").isGroupChat(this.props.thread.thread_id);b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(d,{onBlock:this.props.onBlock,onDelete:this.$16,onToggle:this.$17,isGroupChat:e})}.bind(this));new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_attempt").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.thread.thread_id)).setSurface(t(this.props.folder)).setFolderType("pending").setThreadKey(c).setEntryPoint("inbox_banner").log()}.bind(this),"MessengerThreadlistRow.react")}.bind(this)}))};a.prototype.$12=function(){if(!this.$3(this.props.thread))return null;var a=window.callWindow&&!window.callWindow.closed?h._("Return to Call"):h._("Join Call");return b("React").createElement(m,{className:"_4ry5",label:a,onClick:this.$18,type:"primary"})};a.prototype.$7=function(a){return"row_header_id_"+a};a.prototype.$3=function(a){return a.rtc_call_data&&a.rtc_call_data.call_state!==b("RTCCallState").NO_ONGOING_CALL};a.propTypes={isActive:c.bool.isRequired,blockedIds:c.instanceOf(Set).isRequired,isActionsFocused:c.bool,isFocused:c.bool,isMuted:c.bool.isRequired,isDoNotDisturb:c.bool,isPresenceForWork:c.bool,lastMessage:c.object,logClickHandler:c.func,onArchive:c.func.isRequired,onDelete:c.func.isRequired,onMarkRead:c.func.isRequired,onMarkSpam:c.func.isRequired,onMarkUnread:c.func.isRequired,onMute:c.func.isRequired,onPin:c.func.isRequired,onSelect:c.func.isRequired,onUnmute:c.func.isRequired,onIgnore:c.func.isRequired,onBlock:c.func.isRequired,onUnblock:c.func.isRequired,onUnpin:c.func.isRequired,participants:c.instanceOf(b("immutable").Map).isRequired,readReceipts:c.instanceOf(b("immutable").OrderedMap).isRequired,registerThreadRefs:c.func,showAggregation:c.bool,thread:c.instanceOf(b("ImmutableObject")).isRequired,viewer:c.string.isRequired};e.exports=a}),null);