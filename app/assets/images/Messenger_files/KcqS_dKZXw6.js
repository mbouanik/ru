if (self.CavalryLogger) { CavalryLogger.start_js(["Ffu8T"]); }

__d("MessengerThreadlistRowContainer.react",["fbt","ChatPinnedThreadsEntryPoint","CurrentUser","IgnoreMessagesTypedLogger","ImmutableObject","MercuryIDs","MercuryLogMessageType","MercuryMessageActions","MercuryMessageObject","MercuryMessages","MercuryOrderedThreadlist","MercuryThreadActions","MercuryThreadInfo","MercuryThreadlistConstants","MercuryThreadlistRowContainer.react","MercuryTriodeSourceUtil","MessageRequestUtils","MessagingSourceEnum","MessagingTag","MessengerActions","MessengerAdminGroupUtils","MessengerBlockDialogReact.bs","MessengerConfirmLeaveGroupDialogReact.bs","MessengerDialogs.bs","MessengerGalahadGating.bs","MessengerMessageRequestsTypedLogger","MessengerParticipants.bs","MessengerReadReceipt.bs","MessengerSimpleDialogReact.bs","MessengerThreadlistRow.react","MNPlatformTagsDataManager","React","ReactComponentWithPureRenderMixin","ReactDOM","StoreAndPropBasedStateMixin","WorkGalahadThreadlistRow.react","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("MessengerBlockDialogReact.bs").jsComponent,i=b("MessengerConfirmLeaveGroupDialogReact.bs").jsComponent,j=b("MessengerSimpleDialogReact.bs").jsComponent;a=b("React").PropTypes;c=b("React").createClass({displayName:"MessengerThreadlistRowContainer",mixins:[b("ReactComponentWithPureRenderMixin"),b("StoreAndPropBasedStateMixin")(b("MercuryMessages"))],propTypes:{blockedIds:a.instanceOf(Set).isRequired,isActive:a.bool.isRequired,isTabbable:a.bool,folder:a.string,onScrollIntoView:a.func,onOverrideSelect:a.func,showAggregation:a.bool,showActions:a.bool,readReceipts:a.object,thread:a.instanceOf(b("ImmutableObject")).isRequired,viewer:a.string.isRequired},statics:{calculateState:function(a){var c=b("MercuryMessages").getForFBID(a.viewer),d=a.thread.thread_id;c=c.getThreadMessagesRangeNow(d,0,1)[0];d=b("MercuryOrderedThreadlist").getForFBID(a.viewer);a=d.getPinnedThreadlist();d=a.length>=b("MercuryThreadlistConstants").MAX_PINNED_THREADS;return{lastMessage:c||null,isPinnedThreadBucketFull:d}}},getInitialState:function(){return{readReceipts:b("MessengerReadReceipt.bs").getSeenTimestamps(this.props.readReceipts,this.props.thread.thread_id)}},UNSAFE_componentWillReceiveProps:function(a){a.readReceipts&&this.setState({readReceipts:b("MessengerReadReceipt.bs").getSeenTimestamps(a.readReceipts,a.thread.thread_id)})},componentDidUpdate:function(a){var c=this.props,d=c.onScrollIntoView;c=c.isActive;c&&!a.isActive&&d&&d(b("ReactDOM").findDOMNode(this))},render:function(){return b("React").createElement(b("MercuryThreadlistRowContainer.react"),babelHelpers["extends"]({},this.props,{ChildClass:b("MessengerGalahadGating.bs").isGalahadUIEnabled()?b("WorkGalahadThreadlistRow.react"):b("MessengerThreadlistRow.react"),isMuted:b("MercuryThreadInfo").isMuted(this.props.thread),lastMessage:this.state.lastMessage,onArchive:this._handleArchive,onDelete:this._handleDelete,onLeaveGroup:this._handleLeaveGroup,onMarkRead:this._handleMarkRead,onMarkSpam:this._handleMarkSpam,onMarkUnread:this._handleMarkUnread,onMute:this._handleMute,onPin:this._handlePin,onSelect:this._handleSelect,onUnmute:this._handleUnmute,onUnpin:this._handleUnpin,onIgnore:this._handleIgnore,onBlock:this._handleBlockFromSettingOrDecline,onUnblock:this._handleUnblock,readReceipts:this.state.readReceipts,showActions:this.props.showActions,showLeaveGroup:this.props.thread.is_subscribed&&!this.props.thread.is_canonical}))},_handleArchive:function(){var a=this.props.isActive;this._getThreadActions().archive(this.props.thread.thread_id);a&&b("MessengerActions").selectThread(null)},_handleDelete:function(){var a=this.props.isActive;this._getThreadActions()["delete"](this.props.thread.thread_id);a&&b("MessengerActions").selectThread(null)},_handleMarkRead:function(){this._getThreadActions().markRead(this.props.thread.thread_id)},_handleMarkSpam:function(){var a=this.props.isActive;this._getThreadActions().markSpam(this.props.thread.thread_id);a&&b("MessengerActions").selectThread(null)},_handleMarkUnread:function(){this._getThreadActions().markUnread(this.props.thread.thread_id)},_handleMute:function(a){this._getThreadActions().updateMuteSetting(this.props.thread.thread_id,a)},_handlePin:function(){this.state.isPinnedThreadBucketFull?b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(j,{title:g._("You can't pin any more chats"),body:g._("You can't pin more than 15 chats on Workplace. To pin this chat, try unpinning another chat.")})}):this._getThreadActions().pin(this.props.thread.thread_id,b("ChatPinnedThreadsEntryPoint").MENU_ITEM_IN_THREAD_ROW)},_handleUnpin:function(){this._getThreadActions().unpin(this.props.thread.thread_id,b("ChatPinnedThreadsEntryPoint").MENU_ITEM_IN_THREAD_ROW)},_handleSelect:function(){__p&&__p();var a=b("CurrentUser").getID();a=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.thread.thread_id,a);if(this.props.onOverrideSelect){this.props.onOverrideSelect(this.props.thread);return}b("MessengerActions").selectThread(this.props.thread.thread_id);var c=b("MercuryIDs").getUserIDFromThreadID(this.props.thread.thread_id),d;switch(this.props.folder){case"inbox":d="inbox";break;case"pending":d="pending";break;case"other":d="other";break}this.props.thread.folder!==b("MessagingTag").INBOX&&new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_thread_open").setThreadID(c).setSurface(d).setFolderType(this.props.thread.folder).setThreadKey(a).log();b("MNPlatformTagsDataManager").updateThreadTabAfterSelectThread(b("MessagingSourceEnum").MESSENGER_WEB_SEARCH,c)},_handleUnmute:function(){this._getThreadActions().unmute(this.props.thread.thread_id)},_handleLeaveGroup:function(){if(this.props.viewer){var a=b("MessengerAdminGroupUtils").isAdmin(this.props.thread.admin_ids,this.props.viewer);b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(i,{onLeave:this._onLeaveGroupConfirm,isViewerAdmin:a,thread:this.props.thread})}.bind(this))}},_handleIgnore:function(){var a=this.props.isActive;this._getThreadActions().changeFolder(this.props.thread.thread_id,"other");a&&b("MessengerActions").selectThread(null);new(b("IgnoreMessagesTypedLogger"))().setEvent("ignore_confirmed").setThreadID(this.props.thread.thread_fbid).setPlatform("messengerdotcom").log()},_handleBlockFromSettingOrDecline:function(){__p&&__p();var a=this.props.thread.thread_id;a=b("MercuryIDs").isGroupChat(a);if(a){this._handleIgnore();return}var c=b("MessengerParticipants.bs").getNow(b("MercuryIDs").getParticipantIDFromUserID(this.props.thread.other_user_fbid)),d=c&&c.short_name||g._("sender");b("gkx")("AT54UChk2NoqJXFF1MV8aQRxUoOW3ZErAtJcgLTvrnCV9rvMkUPp0medMsVOVunTnRfJjVXDEMxLY3wQwE_72fY7")?b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(h,{onBlock:function(){this._handleConfirmBlock(d)}.bind(this),contact:c})}.bind(this)):this._handleConfirmBlock(d)},_handleConfirmBlock:function(a){var b=this.props.thread.thread_id;b&&this._getThreadActions().blockIgnoreOnMessengerDotCom(this.props.isActive,b,function(){this._handleAfterBlock(a)}.bind(this))},_handleAfterBlock:function(a){a=this.props.thread;var c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(a.thread_id,b("CurrentUser").getID()),d=!!a&&b("MessageRequestUtils").isFiltered(a);new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_block_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(a.thread_id)).setSurface("thread").setFolderType(d?b("MessagingTag").OTHER:b("MessagingTag").PENDING).setThreadKey(c).setEntryPoint(null).log()},_handleUnblock:function(){this._getThreadActions().unblockOnMessengerDotCom(this.props.thread.thread_id)},_onLeaveGroupConfirm:function(){if(!b("MercuryThreadInfo").isEmptyLocalThread(this.props.thread)){var a=this._getMessageObject().constructLogMessageObject(b("MercuryTriodeSourceUtil").getMercuryTriodeSource(),this.props.thread.thread_id,b("MercuryLogMessageType").UNSUBSCRIBE,{removed_participants:[b("MercuryIDs").getParticipantIDFromUserID(this.props.viewer)]});this._getMessageActions().send(a)}},_getThreadActions:function(){return b("MercuryThreadActions").getForFBID(this.props.viewer)},_getMessageActions:function(){return b("MercuryMessageActions").getForFBID(this.props.viewer)},_getMessageObject:function(){return b("MercuryMessageObject").getForFBID(this.props.viewer)}});e.exports=c}),null);