if (self.CavalryLogger) { CavalryLogger.start_js(["3N+wN"]); }

__d("MessengerInitialDataTransformer.bs",["bs_array","bs_caml_array","MercuryThreadlistConstants","MessengerGraphQLThreadlistFetcher.bs","MessengerServerPayloadTransformer.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){__p&&__p();var c=a.viewer,d=a.is_page,e=a.additional_participant,f;if(e==null)f=[];else{var g=[];b("bs_array").iter(function(a){if(a==null)return 0;else{g.push(b("MessengerServerPayloadTransformer.bs").transformParticipant(a));return 0}},e.messaging_actors);f=g}e=a.thread_list;e=e==null?null:b("MessengerGraphQLThreadlistFetcher.bs").transform(c,[{limit:b("MercuryThreadlistConstants").WEBMESSENGER_THREAD_COUNT+1|0,folder:"inbox",timestamp:null,offset:0,filter:null,onlyPinnedThreads:null}],d,[e]);var h=a.pinned_threads;h=h==null?null:b("MessengerGraphQLThreadlistFetcher.bs").transform(c,[{limit:b("MercuryThreadlistConstants").MAX_PINNED_THREADS+1|0,folder:"inbox",timestamp:null,offset:0,filter:null,onlyPinnedThreads:null}],!1,[h]);var i=a.current_thread,j;if(i==null)j=null;else{i=i.message_thread;j=i==null?null:b("MessengerServerPayloadTransformer.bs").transformThread(c,i,d)}c=e==null?[[],0,[],{},[],[]]:[e.ordered_threadlists,e.pending_folder_unseen_count,e.threads,e.roger,e.participants,e.delivery_receipts];i=c[2];d=a.thread_key;e=d==null?i.filter(function(a){return a.unread_count===0}):[];d=e.length!==0?b("bs_caml_array").caml_array_get(e,0).thread_fbid:null;j==null||i.push(j);e=h==null?[]:h.threads;j=e.map(function(b){var a=b.is_canonical;a=a?b.other_user_fbid:b.thread_fbid;if(a==null)return null;else return a});h=i.filter(function(a){return!a.is_pinned});i=h.concat(e);return[{ordered_threadlists:c[0],threads:i,roger:c[3],participants:c[4].concat(f),pending_folder_unseeen_count:c[1],delivery_receipts:c[5],payload_source:"server_initial_data",pinned_thread_ids:j,current_montage_thread:a.current_montage_thread},d]}f.transform=a}),null);